<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no, address=no, email=no">

    <link rel="shortcut icon" href="../resource/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="../resource/images/favicon.ico" type="image/x-icon">

    <title>:: Js Background url</title>

    <link rel="stylesheet" type="text/css" href="../resource/css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

</head>

<body>

    <h1 class="hide">JavaScript Background Image URL 받아오기</h1>
    <div id="wrap">
        <main id="main">
            <h2><span>Js Get Background URL</span></h2>
            <p class="content-text-c">
                JavaScript Background Image URL 받아오기
            </p>
            <p class="content-text">
                이전 홈페이지 유지/보수 작업 중
                메인 비주얼 영역의 슬라이드에 모션 효과를 추가해달라는 업무 요청을 받은 적이 있다.

                그 사이트는 어드민 에디터로 관리되는 홈페이지였기에 데이터값으로 뿌려진 코드들이라 직접적인 추가,수정이 불가능했고
                당장 수정이 되어야 하는 상황이라 해당 작업을 진행했던 기억이 있다.

                언젠가 활용할 수 있을때를 대비해 그 때 사용한 JavaScript 코드를 올려두었다.
            </p>
            <figure class="content-img">
                <img src="images/bg_01.jpg" alt="">
                <img src="images/bg_02.jpg" alt="">
                <figcaption>▲ 페이지에 적용된 코드</figcaption>
            </figure>
            <p class="content-text">
                'background-image' 값 자체를 가져오는건 'getPropertyValue' 를 활용하면 충분하지만
                uri('') 부분을 제외한 순수 경로 (ex. https://www.google.com) 를 가져오기 위해 replace를 사용한다.
            </p>
            <p class="content-text optionT"><strong>■ EX</strong></p>
            <div class="content-box js-bgCopyBox flex-clear">
                <span class="bg-copy-place"></span>
                <p class="bg-copy-text"></p>
            </div>
            <ul class="content-box js-bgCopyBox">
                <li class="bg-copy-unit">
                    <button type="button" class="ex-btn bg-copy-btn">copy btn</button>
                </li>
                <li class="bg-copy-unit">
                    <button type="button" class="ex-btn bg-copy-btn">copy btn</button>
                </li>
                <li class="bg-copy-unit">
                    <button type="button" class="ex-btn bg-copy-btn">copy btn</button>
                </li>
                <li class="bg-copy-unit">
                    <button type="button" class="ex-btn bg-copy-btn">copy btn</button>
                </li>
            </ul>
        </main>
    </div>
    <script type="text/javascript">
        (function(a){
            let $el = {
                btn : a.querySelectorAll('.bg-copy-btn'),
            };

            [].forEach.call( $el.btn, ( el ) => {
                el.addEventListener( 'click' , ( e ) => {
                    let $p = (e.target).parentElement,
                    $styleL = getComputedStyle($p),
                    $bg01 = $styleL.backgroundImage,
                    $bg02 = $bg01.replace(/^url\(['"](.+)['"]\)/, '$1');

                    let $bg03 = getComputedStyle($p).getPropertyValue('background-image');

                    let $bg04 = getComputedStyle($p).getPropertyValue('background-image').replace(/^url\(['"](.+)['"]\)/, '$1');

                    let $bgBox = a.querySelector('.bg-copy-place');
                    let $bgText = a.querySelector('.bg-copy-text');
                    $bgBox.style.backgroundImage = `url('${$bg02}')`;
                    $bgText.innerHTML = `${$bg02}`;

                    console.log($bg02);
                    console.log($bg03);
                    console.log($bg04);
                });
            });
        })(document);
    </script>
    
</body>
</html>